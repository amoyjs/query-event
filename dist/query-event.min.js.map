{"version":3,"file":"query-event.min.js","sources":["../lib/touch/eventBus.ts","../lib/touch/utils.ts","../lib/touch/index.ts","../lib/index.ts"],"sourcesContent":["export default class EventBus {\n    private handlers: QueryEvent.Handler[] = []\n    public add(handler: QueryEvent.Handler) {\n        this.handlers.push(handler)\n        return this\n    }\n    public del(handler: QueryEvent.Handler) {\n        if (!handler) {\n            this.handlers = []\n        } else {\n            this.handlers.map((value, index) => {\n                value === handler && this.handlers.splice(index, 1)\n            })\n        }\n        return this\n    }\n    public fire(evObj: QueryEvent.RTouchEvent, that?: any) {\n        if (!this.handlers || !this.handlers.length) return\n        this.handlers.map((handler) => {\n            if (typeof handler === 'function') handler.bind(that)(evObj)\n        })\n        return this\n    }\n    public clear() {\n        this.handlers = []\n    }\n}\n","import { getValue } from '@amoy/common'\n\nconst u = { \n    getCurTargetByEv(evTarget: any, ev: QueryEvent.PixiEvent) {\n        let curTarget\n        let maxZindex = 0\n        if (getValue(evTarget, 'children.length')) {\n            evTarget.children.map((child) => {\n                if (child.containsPoint) {\n                    if (child.containsPoint(ev.data.global) && child.zIndex >= maxZindex) {\n                        curTarget = child\n                        maxZindex = child.zIndex\n                    }\n                }\n            })\n        }\n\n        if (curTarget) {\n            const childCurTarget = u.getCurTargetByEv(curTarget, ev)\n            if (childCurTarget) {\n                curTarget = childCurTarget\n            }\n        }\n        return curTarget || evTarget\n    },\n    getFingers(ev: QueryEvent.PixiEvent) {\n        return getValue(ev, 'data.originalEvent.touches.length') || 1\n    },\n    getPoint(ev: QueryEvent.PixiEvent, index: 0 | 1) {\n        if (ev.data.pointerType === 'touch') {\n            const touches = ev.data.originalEvent.touches\n            return {\n                x: Math.round(touches[index].pageX),\n                y: Math.round(touches[index].pageY),\n            }\n        } else {\n            return {\n                x: Math.round(ev.data.global.x),\n                y: Math.round(ev.data.global.y),\n            }\n        }\n    },\n    getVector(p1: QueryEvent.Point, p2: QueryEvent.Point) {\n        const x = Math.round(p1.x - p2.x)\n        const y = Math.round(p1.y - p2.y)\n        return { x, y }\n    },\n    getLength(v1: QueryEvent.Point) {\n        return Math.sqrt(v1.x * v1.x + v1.y * v1.y)\n    },\n    getAngle(v1: QueryEvent.Point, v2: QueryEvent.Point) {\n        if (typeof v1 !== 'object' || typeof v2 !== 'object') {\n            console.error('getAngle error!')\n            return\n        }\n        // 判断方向，顺时针为 1 ,逆时针为 -1；\n        const direction = v1.x * v2.y - v2.x * v1.y > 0 ? 1 : -1\n            // 两个向量的模；\n        const len1 = this.getLength(v1)\n        const len2 = this.getLength(v2)\n        const mr = len1 * len2\n        let dot\n        let r\n        if (mr === 0)return 0\n        // 通过数量积公式可以推导出：\n        // cos = (x1 * x2 + y1 * y2)/(|a| * |b|);\n        dot = v1.x * v2.x + v1.y * v2.y\n        r = dot / mr\n        if (r > 1)r = 1\n        if (r < -1)r = -1\n        // 解值并结合方向转化为角度值；\n        return Math.acos(r) * direction\n    },\n    getAnchorPoint(target: any) {\n        return {\n            x: target.x,\n            y: target.y,\n        }\n    },\n}\n\nexport default u\n","import * as PIXI from 'pixi.js'\nimport EventBus from './eventBus'\nimport u from './utils'\n\nexport const RTOUCH_SUPPORT_EVENT = [\n    'touchstart',\n    'touchmove',\n    'touchend',\n    // 拖动\n    'drag',\n    'dragstart',\n    'dragend',\n    // 双指缩放\n    'pinch',\n    'pinchstart',\n    'pinchend',\n    // 双指旋转\n    'rotate',\n    'rotatestart',\n    'rotateend',\n    // 划动\n    'swipeleft',\n    'swiperight',\n    'swipeup',\n    'swipedown',\n    // 短点击\n    'shorttap',\n    'longtap',\n    // 单指缩放\n    'singlepinch',\n    'singlepinchstart',\n    'singlepinchend',\n    // 单指旋转\n    'singlerotate',\n    'singlerotatestart',\n    'singlerotateend',\n]\n\n// 挟持的原生事件\nconst ORIGIN_EVENT_MAP = [{\n    name: 'pointerdown',\n    fn: '_start',\n}, {\n    name: 'pointermove',\n    fn: '_move',\n}, {\n    name: 'pointerup',\n    fn: '_end',\n}, {\n    name: 'pointerupoutside',\n    fn: '_end',\n}]\n\n// 事件中心\n\nexport default class RTouch {\n    // 精灵\n    private target: PIXI.Sprite | PIXI.Graphics | PIXI.Text\n    // 触摸手指数量\n    private fingers: number = 0\n    // 第一触控点\n    private swipeStartPoint: QueryEvent.Point | null\n    private startPoint: QueryEvent.Point | null\n    private startTime: number\n    // 第二触控点\n    private secondPoint: QueryEvent.Point | null\n    // 初始向量\n    private vector1: QueryEvent.Point | null\n    // 初始向量模\n    private pinchStartLength: number | null\n    // 是否开始触摸\n    // 用于解决 精灵区域外 move 也被触发的问题\n    private touching: boolean = false\n\n    private isSingleButton: boolean = false\n    private singleBasePoint: QueryEvent.Point\n    private singlePinchStartLength: number\n\n    private longtapTimer\n    private Bus: {\n        [evName: string]: EventBus,\n    } = {}\n    constructor(target: PIXI.Sprite | PIXI.Graphics | PIXI.Text) {\n        this.target = target\n        // 初始化事件中心\n        this.initEventBus()\n        // 事件挟持\n        this.bindOriginEvent()\n    }\n    private initEventBus() {\n        RTOUCH_SUPPORT_EVENT.map((evName: string) => {\n            Object.defineProperty(this.Bus, evName, { value: new EventBus() })\n        })\n    }\n    private bindOriginEvent() {\n        ORIGIN_EVENT_MAP.map(({name, fn}) => {\n            this.target.interactive = true\n            this.target.on(name, this[fn], this)\n        })\n    }\n    public _start(ev: QueryEvent.PixiEvent) {\n        this.touching = true\n        this.startTime = Date.now()\n        this.fingers = u.getFingers(ev)\n        // 记录第一触控点\n        this.swipeStartPoint = this.startPoint = u.getPoint(ev, 0)\n        \n        // 判断触控区域是否为单指操作的按钮\n        this.singleBasePoint = u.getAnchorPoint(this.target)\n        const curTarget = u.getCurTargetByEv(ev.target, ev)\n        this.isSingleButton = curTarget && (curTarget.name === 'singlebutton')\n\n        if (this.fingers === 1) {\n            // 单指且监听 singlePinch 时，计算向量模；\n            const startVector = u.getVector(this.startPoint, this.singleBasePoint)\n            this.singlePinchStartLength = u.getLength(startVector)\n        } else if (this.fingers > 1) {\n            // 双指操作时，记录第二触控点\n            this.secondPoint = u.getPoint(ev, 1)\n            // 计算双指向量；\n            this.vector1 = u.getVector(this.secondPoint, this.startPoint)\n            // 计算向量模\n            this.pinchStartLength = u.getLength(this.vector1)\n        }\n\n        // 触发长按\n        this.longtapTimer = setTimeout(() => {\n            this.fireEvent('longtap', {\n                origin: ev,\n            })\n            this.longtapTimer = null\n        }, 1000)\n\n        this.fireEvent('touchstart', {\n            origin: ev,\n        })\n    }\n    public _move(ev: QueryEvent.PixiEvent) {\n        if (!this.touching) return\n        const curPoint = u.getPoint(ev, 0)\n        \n        if (!this.startPoint) this.startPoint = curPoint\n        if (this.fingers > 1) {\n            // 双指操作， 触发 pinch 与 rotate\n            const curSecPoint = u.getPoint(ev, 1)\n            const vector2 = u.getVector(curSecPoint, curPoint)\n            const pinchLength = u.getLength(vector2)\n\n            if (this.pinchStartLength) {\n                this.eventStart('pinch', {\n                    origin: ev,\n                    delta: {\n                        scale: pinchLength / this.pinchStartLength,\n                    },\n                })\n                this.pinchStartLength = pinchLength\n            }\n\n            if (this.vector1) {\n                this.eventStart('rotate', {\n                    delta: {\n                        rotate: u.getAngle(this.vector1, vector2),\n                    },\n                    origin: ev,\n                })\n                this.vector1 = vector2\n            }\n        } else {\n            // 触发 单指缩放\n            if (this.isSingleButton) {\n                const pinchV2 = u.getVector(curPoint, this.singleBasePoint)\n                const singlePinchLength = u.getLength(pinchV2)\n\n                this.eventStart('singlepinch', {\n                    delta: {\n                        scale: singlePinchLength / this.singlePinchStartLength,\n                        deltaX: curPoint.x - this.startPoint.x,\n                        deltaY: curPoint.y - this.startPoint.y,\n                    },\n                    origin: ev,\n                })\n                this.singlePinchStartLength = singlePinchLength\n            }\n            // 触发 单指旋转;\n            if (this.isSingleButton) {\n                const rotateV1 = u.getVector(this.startPoint, this.singleBasePoint)\n                const rotateV2 = u.getVector(curPoint, this.singleBasePoint)\n\n                this.eventStart('singlerotate', {\n                    delta: {\n                        rotate: u.getAngle(rotateV1, rotateV2),\n                    },\n                    origin: ev,\n                })\n            }\n        }\n\n        // 触发 drag\n        this.eventStart('drag', {\n            delta: {\n                x: curPoint.x - this.startPoint.x,\n                y: curPoint.y - this.startPoint.y,\n            },\n            origin: ev,\n        })\n\n        this.fireEvent('touchmove', {\n            origin: ev,\n        })\n\n        this.startPoint = curPoint\n    }\n    public _end(ev: QueryEvent.PixiEvent) {\n        const evArr = ['pinch', 'drag', 'rotate', 'singlerotate', 'singlepinch']\n        this.touching = false\n        this.fingers = u.getFingers(ev)\n\n        evArr.map((evName: string) => {\n            this.eventEnd(evName, {\n                origin: ev,\n                type: evName,\n            })\n        })\n\n        if (this.swipeStartPoint) {\n            const endPoint = {\n                x: Math.round(ev.data.global.x),\n                y: Math.round(ev.data.global.y),\n            }\n            const deltaX = endPoint.x - this.swipeStartPoint.x\n            const deltaY = endPoint.y - this.swipeStartPoint.y\n            const endTime = Date.now()\n            let eventType: string = ''\n            if (deltaX > 30 && Math.abs(deltaY) < 100) {\n                // 右划\n                eventType = 'swiperight'\n            } else if (deltaX < -30 && Math.abs(deltaY) < 100) {\n                // 左划\n                eventType = 'swipeleft'\n            } else if (deltaY > 30 && Math.abs(deltaX) < 100) {\n                // 下划\n                eventType = 'swipedown'\n            } else if (deltaY < -30 && Math.abs(deltaX) < 100) {\n                // 上划\n                eventType = 'swipeup'\n            } else if (Math.abs(deltaX) < 30 && Math.abs(deltaY) < 30 ) {\n                if (endTime - this.startTime < 500) {\n                    // 触发短点击\n                    eventType = 'shorttap'\n                }\n            }\n\n            if (eventType) {\n                this.fireEvent(eventType, {\n                    origin: ev,\n                })\n            }\n        }\n\n        this.fireEvent('touchend', {\n            origin: ev,\n        })\n\n        if (this.longtapTimer) clearTimeout(this.longtapTimer)\n    }\n    private fireEvent(evName: string, ev: {\n        origin: QueryEvent.PixiEvent,\n        [any: string]: any,\n    }) {\n        if (this.Bus[evName]) {\n            this.Bus[evName].fire(Object.assign(ev, {\n                type: evName,\n                stopPropagation() {\n                    ev.origin.stopPropagation()\n                },\n            }), this.target)\n        }\n    }\n    public destory() {\n        ORIGIN_EVENT_MAP.map(({name, fn}) => {\n            this.target.off(name, this[fn], this)\n        })\n    }\n\n    private eventStart(evName: string, ev: {\n        origin: QueryEvent.PixiEvent,\n        [any: string]: any,\n    }) {\n        const ing = `${evName}ing`\n        const start = `${evName}start`\n        if (!this[ing]) {\n            this.fireEvent(start, ev)\n            this[ing] = true\n        } else {\n            this.fireEvent(evName, ev)\n        }\n    }\n\n    private eventEnd(evName: string, ev: QueryEvent.RTouchEvent) {\n        const ing = `${evName}ing`\n        const end = `${evName}end`\n        if (this[ing]) {\n            ev.type = end\n            this.fireEvent(end, ev)\n            this[ing] = false\n        }\n    }\n\n    public on(evName: string, handler: QueryEvent.Handler) {\n        const _evName = evName.trim().toLowerCase()\n        _evName.split(' ').map((name: string) => {\n            this.Bus[name].add(handler)\n        })\n        return this\n    }\n\n    public off(evName: string, handler?: QueryEvent.Handler) {\n        const _evName = evName.trim().toLowerCase()\n        _evName.split(' ').map((name: string) => {\n            handler ? this.Bus[name].del(handler) : this.Bus[name].clear()\n        })\n        return this\n    }\n}\n","import RTouch, { RTOUCH_SUPPORT_EVENT } from './touch'\nexport { RTOUCH_SUPPORT_EVENT } from './touch'\n\ntype callback = (ev: QueryEvent.RTouchEvent) => void\n\nexport function on(target: any, evName: string, fn: callback) {\n    if (RTOUCH_SUPPORT_EVENT.includes(evName)) {\n        if (!target['RTouch']) target['RTouch'] = new RTouch(target)\n        target['RTouch'].on(evName, fn)\n    } else {\n        target.interactive = true\n        target.on(evName, fn)\n    }\n    return target\n}\n\nexport function off(target: any, evName: string, fn?: callback) {\n    if (RTOUCH_SUPPORT_EVENT.includes(evName) && target['RTouch']) {\n        target['RTouch'].off(evName, fn)\n    } else {\n        target.interactive = true\n        target.off(evName, fn)\n    }\n    return target\n}\n\nexport const queryEvent = {\n    on(this: any, name: string = '', closure: () => void = () => { }) {\n        const events = name.split(' ')\n        for (let i = 0; i < this.length; i++) {\n            for (let j = 0; j < events.length; j++) {\n                this[i].interactive = true\n                on(this[i], events[j], closure)\n            }\n        }\n        return this\n    },\n    off(this: any, name: string = '') {\n        const events = name.split(' ')\n        for (let i = 0; i < this.length; i++) {\n            for (let j = 0; j < events.length; j++) {\n                this[i].off(events[j])\n                off(this[i], events[j])\n            }\n        }\n        return this\n    },\n}\n\nexport default queryEvent\n"],"names":["EventBus","handler","this","handlers","push","map","value","index","_this","splice","evObj","that","length","bind","u","getCurTargetByEv","evTarget","ev","curTarget","maxZindex","getValue","children","child","containsPoint","data","global","zIndex","childCurTarget","getFingers","getPoint","pointerType","x","Math","round","y","touches","originalEvent","pageX","pageY","getVector","p1","p2","getLength","v1","sqrt","getAngle","v2","r","direction","mr","acos","console","error","getAnchorPoint","target","RTOUCH_SUPPORT_EVENT","ORIGIN_EVENT_MAP","name","fn","RTouch","evName","Object","defineProperty","Bus","_a","interactive","on","touching","startTime","Date","now","fingers","swipeStartPoint","startPoint","singleBasePoint","isSingleButton","startVector","singlePinchStartLength","secondPoint","vector1","pinchStartLength","longtapTimer","setTimeout","fireEvent","origin","curPoint","curSecPoint","vector2","pinchLength","eventStart","delta","scale","rotate","pinchV2","singlePinchLength","deltaX","deltaY","rotateV1","rotateV2","eventEnd","type","endPoint","endTime","eventType","abs","clearTimeout","fire","assign","stopPropagation","off","ing","start","end","trim","toLowerCase","split","add","del","clear","initEventBus","bindOriginEvent","includes","queryEvent","closure","events","i","j"],"mappings":"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"}